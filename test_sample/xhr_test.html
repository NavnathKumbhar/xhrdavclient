<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>テストページ - XHR</title>
  <script src="../closure-library/closure/goog/base.js" type="text/javascript"></script>
  <script type="text/javascript">
    goog.require('goog.testing.AsyncTestCase');
    goog.require('goog.testing.jsunit');
    goog.require('goog.net.XhrIo');
  </script>
</head>
<body>
  <script type="text/javascript">
    var asyncTestCase = goog.testing.AsyncTestCase.createAndInstall();

    function testXhrIo() {
      asyncTestCase.waitForAsync('XhrIo');  // 非同期
      goog.net.XhrIo.send('test.json', function(e) {
        var xhr = e.target;
        assertTrue('読み込み成功?', xhr.isSuccess());
        var obj = xhr.getResponseJson();
        assertNotNullNorUndefined('JSONレスポンス', obj);
        asyncTestCase.continueTesting();  // 終了待ち状態を終了
      });
    }

  </script>
</body>
</html>
