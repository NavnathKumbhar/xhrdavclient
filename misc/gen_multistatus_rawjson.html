<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <script src="../closure-library/closure/goog/base.js" type="text/javascript"></script>
  <script src="../xhrdavclientdeps.js" type="text/javascript"></script>
  <script src="../test/utils.js" type="text/javascript"></script>
  <script type="text/javascript">
    goog.require('goog.json');
    goog.require('goog.object');
    goog.require('goog.array');
    goog.require('goog.string');
    goog.require('goog.string.path');
    goog.require('goog.net.XhrManager');
    goog.require('goog.net.XhrIo');
    goog.require('goog.dom.xml');
    goog.require('goog.ds.JsDataSource');
    goog.require('xhrdav.lib.Client');
    goog.require('xhrdav.lib.DomParser');
    goog.require('xhrdav.lib.functions.DomParse');

    goog.require('goog.debug.Console');
    goog.require('goog.debug.Logger');
  </script>
</head>
<body>
  <script type="text/javascript">
    var dir = '/mydav/';

    var initData;
    var func = xhrdav.lib.functions.DomParse;

    var dav = new xhrdav.lib.Client();
    var httpStatus = xhrdav.lib.HttpStatus;
    var httpStatusText = xhrdav.lib.HttpStatus.text;

    // Load fixture by jsonp
    var fixtureData;
    var multistatusCurrentdir = function(json) {
      fixtureData = json;
      initData = goog.dom.xml.loadXml(
        fixtureData['xml'].split('\n').join(''));
//      console.log(initData);
      var doc = func.ParseRawMultiStatus(initData);
//      console.log(doc);
      var funcName = 'multistatusCurrentDirParseRaw';
      var obj = {json: doc};
      var jsonData = goog.json.serialize(obj);
      var jsonpData = goog.string.buildString(funcName, '(', jsonData, ')');
      var uploadPath = goog.string.path.normalizePath(
        goog.string.path.join(dir, funcName + '.js'));
      dav.put(uploadPath, jsonpData);
    }
    loadJson('../fixtures/multistatus_currentdir.js');

  </script>
</body>
</html>
